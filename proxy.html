<!doctype html>
<html lang="en">
<head>
  <script type="text/javascript">
    function respondToMessage(messageEvent) {
      if (messageEvent.name == "getSettingValue") {
        var value = safari.extension.settings.getItem(messageEvent.message);

        // return value of foo to injected script
        safari.application.activeBrowserWindow.activeTab.page.dispatchMessage("settingValueIs", value);
      }
    }

    safari.application.addEventListener("message",respondToMessage,false);
  </script>
</head>
<body></body>
</html>
